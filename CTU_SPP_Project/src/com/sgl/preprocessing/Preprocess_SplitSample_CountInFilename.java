package com.sgl.preprocessing;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;


/**
 * 统计文件内的记录数，并更改文件名（将记录数放在文件名之后）
 * @author sgl
 *
 */
public class Preprocess_SplitSample_CountInFilename {
	public static void main(String[] args) {
		String srcDir = args[0];
//		SplitSample_CountInFilename(srcDir, "2013-08-20_capture-win1.netflow__10.0.2.15__108.218.11.246__udp.txt");
		File[] filelist = (new File(srcDir)).listFiles();
		for(int i = 0; i<filelist.length; i++) {
			System.out.println(i);
			String filename = filelist[i].getName();
			String[] items = filename.split("__");
			if(items.length==4)
				SplitSample_CountInFilename(srcDir, filename);
		}
	}
	public static void SplitSample_CountInFilename(String srcDir, String filename) {

		try {
			BufferedReader br = new BufferedReader(new FileReader(new File(srcDir+filename)));
			int count = 0;

			String line = null;

			while((line = br.readLine())!=null)
			{
				line = line.trim();
				if(line.length()<10)
					continue;
				count++;
			}
			br.close();

			File oldfile = new File(srcDir+filename);
			File newfile = new File(srcDir+filename.replace(".txt", "__"+count+".txt"));
//			if(count<10)
//				oldfile.delete();
//			else
				oldfile.renameTo(newfile);
			//FileUtil
		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}




}
