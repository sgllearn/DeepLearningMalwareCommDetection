
--------------------------------

1. Data preprocessing (Implemented based on Scala and Java)

a. Download the original CTU Malware Dataset (As listed in “CTU_Malware_Dataset_Urls.txt”) into the [Orignal_Dir]

Tips: [Orignal_Dir] is a folder for storing sample files.

b. Reformat each flow data in the original CTU Malware Dataset into a specified data format. The format is: “SrcIP,DstIP,SrcPort,DstPort,Proto,SendPacketCount,ReceivePacketCount,PacketCount,SendLength,ReceiveLength,TotalLength,Time,FirstPacketArrive,LastPacketArrive,Duration,Label”.

Command: java -cp CTU_SPP.jar com.sgl.preprocessing.Preprocess_Reformat [Orignal_Dir] [Reformat_Dir]

Tips: [Reformat_Dir] is a folder for storing the reformat files.

c. Aggregate flows into communication pairs.

Command: java -cp CTU_SPP.jar com.sgl.preprocessing.Preprocess_SplitSample [Reformat_Dir] [CommPair_Dir]

Tips: [CommPair_Dir] is a folder for storing the files of communication pairs.

d. Count the flow records in each CommPair file and rename the filename (The number of flows is reflected in the filename so that the SPP-encoding program (com.sgl.spp.SPPNetEncoding) can filter the CommPair files with fewer samples according to the filename.)

Command: java -cp CTU_SPP.jar com.sgl.preprocessing.Preprocess_SplitSample_CountInFilename [CommPair_Dir]

2. SPP-encoding (Implemented based on Scala and Java)

a. Encoding the CommPair files into 1134-dimensional data

Command: java -cp CTU_SPP.jar com.sgl.spp.SPPNetEncoding [CommPair_Dir] [Label] [SPP_File]

Tips: [Label] indicates the type (Normal or Malware) of CommPair files under the current folder ([CommPair_Dir]). [SPP_File] indicates the file that stores the encoding result.

b. Normalization of encoding data

Command: java -cp CTU_SPP.jar com.sgl.preprocessing.Preprocess_Normalization_ZScore [SPP_Dir] 1134 calParam; java -cp CTU_SPP.jar com.sgl.preprocessing.Preprocess_Normalization_ZScore [SPP_Dir] 1134 doNormalization

Tips: [SPP_Dir] is a folder for storing SPP_Files. In order to make the program run normally, the filename of each [SPP_File] in [SPP_Dir] should start with "with_label_".

3. Extracting the features from the SPP_Files (Implemented based on Keras and TensorFlow)

Command: python ExtractFeature2CSV.py [k] [K] [Malware_Sample_File] [Normal_Sample_File]

Tips: [K] indicates K-fold cross-validation. [k] indicates the k-th cross-validation
